
![20231210214023.png](attachments/微服务/20231210214023.png)

# SpringCloud 五大组件有哪些
- Eureka ：注册中心
- Ribbon：负载均衡
- Feign：远程调用
- Hystrix：服务熔断
- Zuul/Gateway：网关

![20231210214549.png](attachments/微服务/20231210214549.png)
# 服务注册和发现，SpringCloud如何实现服务注册发现
- 微服务中必须要使用的组件
- 常见的注册中心：Eureka、Nacos、Zookeeper
  ![20231210223958.png](attachments/微服务/20231210223958.png)

# Nacos
![20231211110620.png](attachments/微服务/20231211110620.png)

# Ribbon

![20231211112051.png](attachments/微服务/20231211112051.png)
# Hystrix
## 服务雪崩
![20231211112756.png](attachments/微服务/20231211112756.png)
## 服务降级
![20231211112429.png](attachments/微服务/20231211112429.png)
## 服务熔断
![20231211112658.png](attachments/微服务/20231211112658.png)

# 监控
为什么需要监控
- 问题定位
- 性能分析
- 服务关系
- 服务告警

工具
- SpringBoot-admin
- prometheus+ Grafana
- zipkin
- skywalking      这两个是链路追踪工具

## skywalking
- ![20231211113900.png](attachments/微服务/20231211113900.png)
## ==============

![20231211113942.png](attachments/微服务/20231211113942.png)

# 限流
![20231211114432.png](attachments/微服务/20231211114432.png)

## Nginx限流
- 控制速率（突发流量）
  ![20231211114800.png](attachments/微服务/20231211114800.png)
- 控制并发连接数
  ![20231211115045.png](attachments/微服务/20231211115045.png)

## 网关限流

![20231211115405.png](attachments/微服务/20231211115405.png)

## ===================
![20231211115552.png](attachments/微服务/20231211115552.png)

限流常见算法：漏桶算法、令牌桶算法

# CAP
一致性、可用性、分区容错性
CP 一致性
AP 可用性

## =============
![20231211120256.png](attachments/微服务/20231211120256.png)

# 分布式事务
## Seata架构
![20231211120511.png](attachments/微服务/20231211120511.png)
### XA模式
![20231211120740.png](attachments/微服务/20231211120740.png)

### AT模式 （高可用模式-常用）
![20231211120950.png](attachments/微服务/20231211120950.png)

### TC模式
![20231211121245.png](attachments/微服务/20231211121245.png)

## MQ分布式事务
- 
![20231211121404.png](attachments/微服务/20231211121404.png)
## ==========================
![20231211121509.png](attachments/微服务/20231211121509.png)


# 分布式服务的接口幂等性
幂等： 多次调用方法或者接口不会改变业务状态，可以保证重复调用的结果和单次调用的结果一致

场景：
- 用户重复点击
- MQ消息重复
- 应用使用失败或超时重试机制
  ![20231211121958.png](attachments/微服务/20231211121958.png)

## token+ redis
通过创建token 保存到redis 来保证接口的幂等
![20231211122151.png](attachments/微服务/20231211122151.png)

## 分布式锁
![20231211122326.png](attachments/微服务/20231211122326.png)

## ================

![20231211122412.png](attachments/微服务/20231211122412.png)

# 分布式任务调度

## xxl-job
- 解决集群任务的重复执行问题
- cron表达式定义灵活
- 定时任务失败了，重试和统计
- 任务量大，分片执行
### 路由策略
![20231211122704.png](attachments/微服务/20231211122704.png)
![20231211122718.png](attachments/微服务/20231211122718.png)
### 任务执行失败怎么解决
![20231211122950.png](attachments/微服务/20231211122950.png)

### 大数据量的任务同时执行
- 分片广播
  ![20231211123200.png](attachments/微服务/20231211123200.png)

## ### ====================
![20231211123255.png](attachments/微服务/20231211123255.png)